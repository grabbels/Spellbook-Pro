import{S as kt,i as Tt,s as Lt,U as Nt,w as $e,x as et,y as tt,a3 as V,f as st,t as lt,z as rt,a0 as re,a4 as L,o as Rt,k as a,q as I,a as g,l as n,m as d,r as P,h as u,c as _,n as t,b as Ut,a1 as e,a2 as S,$ as Dt,a6 as Ye}from"../../../../chunks/singletons-4e7778da.js";import{p as Ct}from"../../../../chunks/stores-e4cd7406.js";import{S as St,n as Z,s as wt,h as bt,e as qt,u as Et,p as jt,m as It,v as Ze}from"../../../../chunks/stores-f5e17f9d.js";import{B as Pt}from"../../../../chunks/button-ad6f7d8d.js";import{s as xe}from"../../../../chunks/supabaseClient-e444a6b7.js";function Mt(r){let h,l,o,v,p,N,B,i,k,x,w,W,b,G,j,O,R,$,T,ee,J,ae,ne,ue,ce,D,de,K,oe,ge,z,_e,Q,ve,ye,pe,we,M,A,X,be,q,te,s,f,m,U,De,F,Ce,Y,Se,me,qe,ke,Me,he,Ve,Be,C,Ee,Oe,ze,je,Ae,Fe,Ie,He,We,Pe,Ge,Je,se,Te,ie,Ke,at;return X=new Pt({props:{text:"back",href:"/",type:"outline",icon:"ri-arrow-left-s-line"}}),se=new Pt({props:{href:"",type:"fill",icon:"",text:"Register"}}),se.$on("click",r[32]),{c(){h=a("div"),l=a("div"),o=a("div"),v=a("div"),p=a("h2"),N=I("Register"),B=g(),i=a("form"),k=a("input"),x=g(),w=a("input"),W=g(),b=a("input"),G=g(),j=a("input"),O=g(),R=a("input"),$=g(),T=a("label"),ee=I("I agree to the "),J=a("button"),ae=I("terms and conditions"),ne=I("."),ue=a("br"),ce=g(),D=a("button"),de=I(`Register
							`),K=a("div"),oe=a("i"),ge=g(),z=a("p"),_e=I("Already have an account? "),Q=a("button"),ve=I("Click here"),ye=I(" to log in."),we=g(),M=a("div"),A=a("div"),$e(X.$$.fragment),be=g(),q=a("div"),te=a("h2"),s=I("Login"),f=g(),m=a("form"),U=a("input"),De=g(),F=a("input"),Ce=g(),Y=a("button"),Se=I(`Login
							`),me=a("div"),qe=a("i"),Me=g(),he=a("p"),Ve=I("No account yet? Create one to:"),Be=g(),C=a("ul"),Ee=a("li"),Oe=I("Manage your spellsheets from anywhere"),ze=g(),je=a("li"),Ae=I("Save and sync your spellsheets across devices"),Fe=g(),Ie=a("li"),He=I("Save multiple spellsheets"),We=g(),Pe=a("li"),Ge=I("Manage your spellsheets in your account"),Je=g(),$e(se.$$.fragment),this.h()},l(c){h=n(c,"DIV",{class:!0});var E=d(h);l=n(E,"DIV",{class:!0});var nt=d(l);o=n(nt,"DIV",{class:!0});var ot=d(o);v=n(ot,"DIV",{class:!0});var Le=d(v);p=n(Le,"H2",{class:!0});var it=d(p);N=P(it,"Register"),it.forEach(u),B=_(Le),i=n(Le,"FORM",{class:!0});var y=d(i);k=n(y,"INPUT",{type:!0,placeholder:!0}),x=_(y),w=n(y,"INPUT",{type:!0,placeholder:!0}),W=_(y),b=n(y,"INPUT",{type:!0,autocomplete:!0,placeholder:!0}),G=_(y),j=n(y,"INPUT",{type:!0,placeholder:!0}),O=_(y),R=n(y,"INPUT",{type:!0,name:!0,id:!0,class:!0}),$=_(y),T=n(y,"LABEL",{for:!0,class:!0});var Ne=d(T);ee=P(Ne,"I agree to the "),J=n(Ne,"BUTTON",{class:!0});var ut=d(J);ae=P(ut,"terms and conditions"),ut.forEach(u),ne=P(Ne,"."),Ne.forEach(u),ue=n(y,"BR",{}),ce=_(y),D=n(y,"BUTTON",{class:!0,type:!0});var Qe=d(D);de=P(Qe,`Register
							`),K=n(Qe,"DIV",{class:!0});var ct=d(K);oe=n(ct,"I",{class:!0}),d(oe).forEach(u),ct.forEach(u),Qe.forEach(u),ge=_(y),z=n(y,"P",{class:!0});var Re=d(z);_e=P(Re,"Already have an account? "),Q=n(Re,"BUTTON",{class:!0});var dt=d(Q);ve=P(dt,"Click here"),dt.forEach(u),ye=P(Re," to log in."),Re.forEach(u),y.forEach(u),Le.forEach(u),ot.forEach(u),nt.forEach(u),we=_(E),M=n(E,"DIV",{id:!0,class:!0});var pt=d(M);A=n(pt,"DIV",{class:!0});var Ue=d(A);et(X.$$.fragment,Ue),be=_(Ue),q=n(Ue,"DIV",{class:!0});var H=d(q);te=n(H,"H2",{class:!0});var mt=d(te);s=P(mt,"Login"),mt.forEach(u),f=_(H),m=n(H,"FORM",{action:!0,class:!0});var fe=d(m);U=n(fe,"INPUT",{type:!0,placeholder:!0}),De=_(fe),F=n(fe,"INPUT",{type:!0,placeholder:!0}),Ce=_(fe),Y=n(fe,"BUTTON",{class:!0,type:!0});var Xe=d(Y);Se=P(Xe,`Login
							`),me=n(Xe,"DIV",{class:!0});var ht=d(me);qe=n(ht,"I",{class:!0}),d(qe).forEach(u),ht.forEach(u),Xe.forEach(u),fe.forEach(u),Me=_(H),he=n(H,"P",{class:!0});var ft=d(he);Ve=P(ft,"No account yet? Create one to:"),ft.forEach(u),Be=_(H),C=n(H,"UL",{class:!0});var le=d(C);Ee=n(le,"LI",{});var gt=d(Ee);Oe=P(gt,"Manage your spellsheets from anywhere"),gt.forEach(u),ze=_(le),je=n(le,"LI",{});var _t=d(je);Ae=P(_t,"Save and sync your spellsheets across devices"),_t.forEach(u),Fe=_(le),Ie=n(le,"LI",{});var vt=d(Ie);He=P(vt,"Save multiple spellsheets"),vt.forEach(u),We=_(le),Pe=n(le,"LI",{});var yt=d(Pe);Ge=P(yt,"Manage your spellsheets in your account"),yt.forEach(u),le.forEach(u),Je=_(H),et(se.$$.fragment,H),H.forEach(u),Ue.forEach(u),pt.forEach(u),E.forEach(u),this.h()},h(){t(p,"class","svelte-1q27tjm"),t(k,"type","text"),t(k,"placeholder","Nickname"),k.required=!0,t(w,"type","email"),t(w,"placeholder","E-Mail"),w.required=!0,t(b,"type","password"),t(b,"autocomplete","new-password"),t(b,"placeholder","Password"),b.required=!0,t(j,"type","password"),t(j,"placeholder","Password (again)"),j.required=!0,t(R,"type","checkbox"),t(R,"name","termsconditions"),t(R,"id","termsconditions"),R.required=!0,t(R,"class","svelte-1q27tjm"),t(J,"class","inline svelte-1q27tjm"),t(T,"for","termsconditions"),t(T,"class","svelte-1q27tjm"),t(oe,"class","ri-loader-5-line svelte-1q27tjm"),t(K,"class","svelte-1q27tjm"),t(D,"class",(r[14]?"loading":"")+" button fill accent svelte-1q27tjm"),t(D,"type","submit"),t(Q,"class","svelte-1q27tjm"),t(z,"class","svelte-1q27tjm"),t(i,"class","svelte-1q27tjm"),t(v,"class","register_form svelte-1q27tjm"),t(o,"class","panel_inner svelte-1q27tjm"),t(l,"class",pe="register section "+r[0]+" svelte-1q27tjm"),t(te,"class","svelte-1q27tjm"),t(U,"type","email"),t(U,"placeholder","E-Mail"),U.required=!0,t(F,"type","password"),t(F,"placeholder","Password"),F.required=!0,t(qe,"class","ri-loader-5-line svelte-1q27tjm"),t(me,"class","svelte-1q27tjm"),t(Y,"class",ke=(r[9]?"loading":"")+" button fill accent svelte-1q27tjm"),t(Y,"type","submit"),t(m,"action","login"),t(m,"class","svelte-1q27tjm"),t(he,"class","svelte-1q27tjm"),t(C,"class","svelte-1q27tjm"),t(q,"class","login_form svelte-1q27tjm"),t(A,"class","panel_inner svelte-1q27tjm"),t(M,"id","login"),t(M,"class",Te="login section "+r[1]+" svelte-1q27tjm"),t(h,"class","grid svelte-1q27tjm")},m(c,E){Ut(c,h,E),e(h,l),e(l,o),e(o,v),e(v,p),e(p,N),e(v,B),e(v,i),e(i,k),S(k,r[3]),e(i,x),e(i,w),S(w,r[4]),e(i,W),e(i,b),S(b,r[5]),e(i,G),e(i,j),S(j,r[6]),e(i,O),e(i,R),e(i,$),e(i,T),e(T,ee),e(T,J),e(J,ae),e(T,ne),e(i,ue),e(i,ce),e(i,D),e(D,de),e(D,K),e(K,oe),e(i,ge),e(i,z),e(z,_e),e(z,Q),e(Q,ve),e(z,ye),r[26](i),r[28](l),e(h,we),e(h,M),e(M,A),tt(X,A,null),e(A,be),e(A,q),e(q,te),e(te,s),e(q,f),e(q,m),e(m,U),S(U,r[7]),e(m,De),e(m,F),S(F,r[8]),e(m,Ce),e(m,Y),e(Y,Se),e(Y,me),e(me,qe),e(q,Me),e(q,he),e(he,Ve),e(q,Be),e(q,C),e(C,Ee),e(Ee,Oe),e(C,ze),e(C,je),e(je,Ae),e(C,Fe),e(C,Ie),e(Ie,He),e(C,We),e(C,Pe),e(Pe,Ge),e(q,Je),tt(se,q,null),r[33](M),ie=!0,Ke||(at=[V(k,"input",r[20]),V(w,"input",r[21]),V(b,"input",r[22]),V(j,"input",r[23]),V(J,"click",r[24]),V(Q,"click",r[25]),V(i,"submit",r[27]),V(U,"input",r[29]),V(F,"input",r[30]),V(m,"submit",r[31])],Ke=!0)},p(c,E){E[0]&8&&k.value!==c[3]&&S(k,c[3]),E[0]&16&&w.value!==c[4]&&S(w,c[4]),E[0]&32&&b.value!==c[5]&&S(b,c[5]),E[0]&64&&j.value!==c[6]&&S(j,c[6]),(!ie||E[0]&1&&pe!==(pe="register section "+c[0]+" svelte-1q27tjm"))&&t(l,"class",pe),E[0]&128&&U.value!==c[7]&&S(U,c[7]),E[0]&256&&F.value!==c[8]&&S(F,c[8]),(!ie||E[0]&512&&ke!==(ke=(c[9]?"loading":"")+" button fill accent svelte-1q27tjm"))&&t(Y,"class",ke),(!ie||E[0]&2&&Te!==(Te="login section "+c[1]+" svelte-1q27tjm"))&&t(M,"class",Te)},i(c){ie||(st(X.$$.fragment,c),st(se.$$.fragment,c),ie=!0)},o(c){lt(X.$$.fragment,c),lt(se.$$.fragment,c),ie=!1},d(c){c&&u(h),r[26](null),r[28](null),rt(X),rt(se),r[33](null),Ke=!1,Dt(at)}}}function Vt(r){let h,l,o,v;return Nt(r[19]),h=new St({props:{name:"login",$$slots:{default:[Mt]},$$scope:{ctx:r}}}),{c(){$e(h.$$.fragment)},l(p){et(h.$$.fragment,p)},m(p,N){tt(h,p,N),l=!0,o||(v=V(window,"resize",r[19]),o=!0)},p(p,N){const B={};N[0]&12287|N[1]&2048&&(B.$$scope={dirty:N,ctx:p}),h.$set(B)},i(p){l||(st(h.$$.fragment,p),l=!0)},o(p){lt(h.$$.fragment,p),l=!1},d(p){rt(h,p),o=!1,v()}}}function Bt(r,h,l){let o,v,p,N,B,i,k,x;re(r,Z,s=>l(34,o=s)),re(r,wt,s=>l(35,v=s)),re(r,bt,s=>l(36,p=s)),re(r,qt,s=>l(37,N=s)),re(r,Et,s=>l(38,B=s)),re(r,Ct,s=>l(39,i=s)),re(r,jt,s=>l(40,k=s)),re(r,It,s=>l(13,x=s));let w,W,b,G,j,O,R,$,T,ee,J,ae,ne,ue;L(jt,k="Login",k),Rt(()=>{i.url.searchParams.get("register")?(l(0,w="show"),l(1,W="")):(l(1,W="show"),l(0,w=""))});function ce(s){var m;s.preventDefault;const f=new URL(i.url);(m=f==null?void 0:f.searchParams)==null||m.set("register","true"),Ze(f),l(0,w="show"),l(1,W="")}function D(s){var m;s.preventDefault;const f=new URL(i.url);(m=f==null?void 0:f.searchParams)==null||m.delete("register"),Ze(f),l(0,w=""),l(1,W="show")}async function de(){if(L(Z,o="",o),O.length>5)if(O===R){const{data:s,error:f}=await xe.from("nicknames").insert([{user_nickname:G}]);if(f.code==23505)L(Z,o="The nickname is already in use, try another one!#error",o);else if(s){const{data:m,error:U}=await xe.auth.signUp({email:j,password:O,options:{data:{nickname:G}}});U?console.log(U):m&&(console.log(m),m.session===null?L(Z,o="An account using your email address already exists. <a href='/account/update-reset'>Forgot password?</a>#error",o):(L(Z,o="Registered succesfully! Please confirm your email address using the email you'll receive shortly. No email? Check your spam-folder or try again.#info",o),b.reset(),D()))}}else L(Z,o="The passwords do not match#error",o);else L(Z,o="Password should be at least 6 characters long#error",o)}async function K(){l(9,ee=!0);const{data:s,error:f}=await xe.auth.signInWithPassword({email:$,password:T});s&&(s.session===null?(L(Z,o="This email and/or password combination is not recognized. Try again?#alert",o),l(9,ee=!1)):s?(L(wt,v=s.session,v),L(Et,B=v.user.id,B),L(qt,N=v.user.user_metadata.nickname,N),L(bt,p=v.user.email,p),Ze("/account")):f&&(console.log(f),l(9,ee=!1),L(Z,o="Oops, an error occurred. Error code: "+f.code+"#error",o)))}function oe(){l(12,ue=window.innerHeight)}function ge(){G=this.value,l(3,G)}function z(){j=this.value,l(4,j)}function _e(){O=this.value,l(5,O)}function Q(){R=this.value,l(6,R)}const ve=()=>L(It,x="terms",x),ye=s=>D(s);function pe(s){Ye[s?"unshift":"push"](()=>{b=s,l(2,b)})}const we=s=>{s.preventDefault,de()};function M(s){Ye[s?"unshift":"push"](()=>{ae=s,l(10,ae)})}function A(){$=this.value,l(7,$)}function X(){T=this.value,l(8,T)}const be=s=>{s.preventDefault,K()},q=s=>ce(s);function te(s){Ye[s?"unshift":"push"](()=>{ne=s,l(11,ne)})}return[w,W,b,G,j,O,R,$,T,ee,ae,ne,ue,x,J,ce,D,de,K,oe,ge,z,_e,Q,ve,ye,pe,we,M,A,X,be,q,te]}class Wt extends kt{constructor(h){super(),Tt(this,h,Bt,Vt,Lt,{},null,[-1,-1])}}export{Wt as default};
